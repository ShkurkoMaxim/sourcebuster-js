{"version":3,"sources":["node_modules/browser-pack/_prelude.js","src/js/sourcebuster.js","sourcebuster.js","src/js/data.js","src/js/helpers/cookies.js","src/js/helpers/uri.js","src/js/helpers/utils.js","src/js/init.js","src/js/migrations.js","src/js/params.js","src/js/terms.js"],"names":["e","exports","module","define","amd","f","window","global","self","sbjs","t","n","r","s","o","u","a","require","i","Error","code","l","call","length","./src/js/sourcebuster.js","_dereq_","init","prefs","this","get","callback","./init","/mnt/d/Work/SKBLAB/sourcebuster-js/src/js/data.js","terms","utils","data","containers","current","current_extra","first","first_extra","session","udata","promocode","service","migrations","delimiter","aliases","main","type","source","medium","campaign","content","term","extra","fire_date","entrance_point","referer","pages_seen","current_page","visits","ip","agent","promo","pack","timezone_offset","setDate","Date","document","location","href","referrer","none","user","user_ip","navigator","userAgent","pages","setLeadingZeroToInt","randomInt","min","max","toString","./helpers/utils","./terms","/mnt/d/Work/SKBLAB/sourcebuster-js/src/js/helpers/cookies.js","encodeData","encodeURIComponent","replace","decodeData","decodeURIComponent","err1","unescape","err2","set","name","value","minutes","domain","excl_subdomains","expires","basehost","date","setTime","getTime","toGMTString","cookie","nameEQ","ca","split","c","charAt","substring","indexOf","destroy","console","log","parse","yummy","cookies","push","prop","hasOwnProperty","i1","cookie_array","unsbjs","i2","tmp_array","result_array","splice","join","string","../data","/mnt/d/Work/SKBLAB/sourcebuster-js/src/js/helpers/uri.js","str","parseOptions","m","parser","strictMode","exec","uri","key","q","$0","$1","$2","strict","loose","getParam","custom_params","query_string","query","search","vars","pair","arr","getHost","request","host","/mnt/d/Work/SKBLAB/sourcebuster-js/src/js/helpers/utils.js","escapeRegexp","offset","utc_offset","getTimezoneOffset","now_hours","getHours","custom_offset","setHours","year","getFullYear","month","getMonth","day","getDate","hour","minute","getMinutes","second","getSeconds","num","size","Math","floor","random","/mnt/d/Work/SKBLAB/sourcebuster-js/src/js/init.js","params","blacklist","mainData","sbjs_data","get_param","utm_source","utm_medium","utm_campaign","utm_content","utm_term","gclid","yclid","p","campaign_param","term_param","content_param","setFirstAndCurrentExtraData","getData","traffic","utm","checkReferer","organic","referral","typein","__sbjs_type","__sbjs_source","__sbjs_medium","__sbjs_campaign","__sbjs_content","__sbjs_term","getUtmTerm","path","typein_attributes","oops","match","text","err","checkRefererHost","isOrganic","isReferral","isolate","host_regex","RegExp","y_host","y_param","g_host","y_host_regex","y_param_regex","g_host_regex","organics","param","display","referrals","lifetime","fetch","go","ldg","includes","Object","values","map","parseInt","pages_count","session_length","./data","./helpers/cookies","./helpers/uri","./migrations","./params","/mnt/d/Work/SKBLAB/sourcebuster-js/src/js/migrations.js","migrate","_with","d","id","mids","advance","version","mid","success","fail","safeReplace","_in","buffer","/mnt/d/Work/SKBLAB/sourcebuster-js/src/js/params.js","validate","checkFloat","checkInt","isString","hostname","ir","io","v","isNumeric","parseFloat","isNaN","prototype","/mnt/d/Work/SKBLAB/sourcebuster-js/src/js/terms.js","social"],"mappings":"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","file":"sourcebuster.min.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","\"use strict\";\r\n\r\nvar init = require('./init');\r\n\r\nvar sbjs = {\r\n  init: function(prefs) {\r\n    this.get = init(prefs);\r\n    if (prefs && prefs.callback && typeof prefs.callback === 'function') {\r\n      prefs.callback(this.get);\r\n    }\r\n  }\r\n};\r\n\r\nmodule.exports = sbjs;","!function(e){if(\"object\"==typeof exports&&\"undefined\"!=typeof module)module.exports=e();else if(\"function\"==typeof define&&define.amd)define([],e);else{var f;\"undefined\"!=typeof window?f=window:\"undefined\"!=typeof global?f=global:\"undefined\"!=typeof self&&(f=self),f.sbjs=e()}}(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({\"./src/js/sourcebuster.js\":[function(_dereq_,module,exports){\n\"use strict\";\r\n\r\nvar init = _dereq_('./init');\r\n\r\nvar sbjs = {\r\n  init: function(prefs) {\r\n    this.get = init(prefs);\r\n    if (prefs && prefs.callback && typeof prefs.callback === 'function') {\r\n      prefs.callback(this.get);\r\n    }\r\n  }\r\n};\r\n\r\nmodule.exports = sbjs;\n},{\"./init\":\"/mnt/d/Work/SKBLAB/sourcebuster-js/src/js/init.js\"}],\"/mnt/d/Work/SKBLAB/sourcebuster-js/src/js/data.js\":[function(_dereq_,module,exports){\n\"use strict\";\r\n\r\nvar terms = _dereq_('./terms'),\r\n    utils = _dereq_('./helpers/utils');\r\n\r\nvar data = {\r\n\r\n  containers: {\r\n    current:          'sbjs_current',\r\n    current_extra:    'sbjs_current_add',\r\n    first:            'sbjs_first',\r\n    first_extra:      'sbjs_first_add',\r\n    session:          'sbjs_session',\r\n    udata:            'sbjs_udata',\r\n    promocode:        'sbjs_promo'\r\n  },\r\n\r\n  service: {\r\n    migrations:       'sbjs_migrations'\r\n  },\r\n\r\n  delimiter:          '|||',\r\n\r\n  aliases: {\r\n\r\n    main: {\r\n      type:           'typ',\r\n      source:         'src',\r\n      medium:         'mdm',\r\n      campaign:       'cmp',\r\n      content:        'cnt',\r\n      term:           'trm'\r\n    },\r\n\r\n    extra: {\r\n      fire_date:      'fd',\r\n      entrance_point: 'ep',\r\n      referer:        'rf'\r\n    },\r\n\r\n    session: {\r\n      pages_seen:     'pgs',\r\n      current_page:   'cpg'\r\n    },\r\n\r\n    udata: {\r\n      visits:         'vst',\r\n      ip:             'uip',\r\n      agent:          'uag'\r\n    },\r\n\r\n    promo:            'code'\r\n\r\n  },\r\n\r\n  pack: {\r\n\r\n    main: function(sbjs) {\r\n      return (\r\n        data.aliases.main.type      + '=' + sbjs.type     + data.delimiter +\r\n        data.aliases.main.source    + '=' + sbjs.source   + data.delimiter +\r\n        data.aliases.main.medium    + '=' + sbjs.medium   + data.delimiter +\r\n        data.aliases.main.campaign  + '=' + sbjs.campaign + data.delimiter +\r\n        data.aliases.main.content   + '=' + sbjs.content  + data.delimiter +\r\n        data.aliases.main.term      + '=' + sbjs.term\r\n      );\r\n    },\r\n\r\n    extra: function(timezone_offset) {\r\n      return (\r\n        data.aliases.extra.fire_date      + '=' + utils.setDate(new Date, timezone_offset) + data.delimiter +\r\n        data.aliases.extra.entrance_point + '=' + document.location.href                   + data.delimiter +\r\n        data.aliases.extra.referer        + '=' + (document.referrer || terms.none)\r\n      );\r\n    },\r\n\r\n    user: function(visits, user_ip) {\r\n      return (\r\n        data.aliases.udata.visits + '=' + visits  + data.delimiter +\r\n        data.aliases.udata.ip     + '=' + user_ip + data.delimiter +\r\n        data.aliases.udata.agent  + '=' + navigator.userAgent\r\n      );\r\n    },\r\n\r\n    session: function(pages) {\r\n      return (\r\n      data.aliases.session.pages_seen   + '=' + pages + data.delimiter +\r\n      data.aliases.session.current_page + '=' + document.location.href\r\n      );\r\n    },\r\n\r\n    promo: function(promo) {\r\n      return (\r\n        data.aliases.promo + '=' + utils.setLeadingZeroToInt(utils.randomInt(promo.min, promo.max), promo.max.toString().length)\r\n      );\r\n    }\r\n\r\n  }\r\n};\r\n\r\nmodule.exports = data;\n},{\"./helpers/utils\":\"/mnt/d/Work/SKBLAB/sourcebuster-js/src/js/helpers/utils.js\",\"./terms\":\"/mnt/d/Work/SKBLAB/sourcebuster-js/src/js/terms.js\"}],\"/mnt/d/Work/SKBLAB/sourcebuster-js/src/js/helpers/cookies.js\":[function(_dereq_,module,exports){\n\"use strict\";\r\n\r\nvar delimiter = _dereq_('../data').delimiter;\r\n\r\nmodule.exports = {\r\n\r\n  encodeData: function(s) {\r\n    return encodeURIComponent(s).replace(/\\!/g, '%21')\r\n                                .replace(/\\~/g, '%7E')\r\n                                .replace(/\\*/g, '%2A')\r\n                                .replace(/\\'/g, '%27')\r\n                                .replace(/\\(/g, '%28')\r\n                                .replace(/\\)/g, '%29');\r\n  },\r\n\r\n  decodeData: function(s) {\r\n    try {\r\n      return decodeURIComponent(s).replace(/\\%21/g, '!')\r\n                                  .replace(/\\%7E/g, '~')\r\n                                  .replace(/\\%2A/g, '*')\r\n                                  .replace(/\\%27/g, \"'\")\r\n                                  .replace(/\\%28/g, '(')\r\n                                  .replace(/\\%29/g, ')');\r\n    } catch(err1) {\r\n      // try unescape for backward compatibility\r\n      try { return unescape(s); } catch(err2) { return ''; }\r\n    }\r\n  },\r\n\r\n  set: function(name, value, minutes, domain, excl_subdomains) {\r\n    var expires, basehost;\r\n\r\n    if (minutes) {\r\n      var date = new Date();\r\n      date.setTime(date.getTime() + (minutes * 60 * 1000));\r\n      expires = '; expires=' + date.toGMTString();\r\n    } else {\r\n      expires = '';\r\n    }\r\n    if (domain && !excl_subdomains) {\r\n      basehost = ';domain=.' + domain;\r\n    } else {\r\n      basehost = '';\r\n    }\r\n    document.cookie = this.encodeData(name) + '=' + this.encodeData(value) + expires + basehost + '; path=/';\r\n  },\r\n\r\n  get: function(name) {\r\n    var nameEQ = this.encodeData(name) + '=',\r\n        ca = document.cookie.split(';');\r\n\r\n    for (var i = 0; i < ca.length; i++) {\r\n      var c = ca[i];\r\n      while (c.charAt(0) === ' ') { c = c.substring(1, c.length); }\r\n      if (c.indexOf(nameEQ) === 0) {\r\n        return this.decodeData(c.substring(nameEQ.length, c.length));\r\n      }\r\n    }\r\n    return null;\r\n  },\r\n\r\n  destroy: function(name, domain, excl_subdomains) {\r\n    console.log('name', name);\r\n    console.log('domain', domain);\r\n    console.log('excl_subdomains', excl_subdomains);\r\n    this.set(name, '', -1, domain, excl_subdomains);\r\n  },\r\n\r\n  parse: function(yummy) {\r\n\r\n    var cookies = [],\r\n        data    = {};\r\n\r\n    if (typeof yummy === 'string') {\r\n      cookies.push(yummy);\r\n    } else {\r\n      for (var prop in yummy) {\r\n        if (yummy.hasOwnProperty(prop)) {\r\n          cookies.push(yummy[prop]);\r\n        }\r\n      }\r\n    }\r\n\r\n    for (var i1 = 0; i1 < cookies.length; i1++) {\r\n      var cookie_array;\r\n      data[this.unsbjs(cookies[i1])] = {};\r\n      if (this.get(cookies[i1])) {\r\n        cookie_array = this.get(cookies[i1]).split(delimiter);\r\n      } else {\r\n        cookie_array = [];\r\n      }\r\n      for (var i2 = 0; i2 < cookie_array.length; i2++) {\r\n        var tmp_array = cookie_array[i2].split('='),\r\n            result_array = tmp_array.splice(0, 1);\r\n        result_array.push(tmp_array.join('='));\r\n        data[this.unsbjs(cookies[i1])][result_array[0]] = this.decodeData(result_array[1]);\r\n      }\r\n    }\r\n\r\n    return data;\r\n\r\n  },\r\n\r\n  unsbjs: function (string) {\r\n    return string.replace('sbjs_', '');\r\n  }\r\n\r\n};\r\n\n},{\"../data\":\"/mnt/d/Work/SKBLAB/sourcebuster-js/src/js/data.js\"}],\"/mnt/d/Work/SKBLAB/sourcebuster-js/src/js/helpers/uri.js\":[function(_dereq_,module,exports){\n\"use strict\";\r\n\r\nmodule.exports = {\r\n\r\n  parse: function(str) {\r\n    var o = this.parseOptions,\r\n        m = o.parser[o.strictMode ? 'strict' : 'loose'].exec(str),\r\n        uri = {},\r\n        i = 14;\r\n\r\n    while (i--) { uri[o.key[i]] = m[i] || ''; }\r\n\r\n    uri[o.q.name] = {};\r\n    uri[o.key[12]].replace(o.q.parser, function ($0, $1, $2) {\r\n      if ($1) { uri[o.q.name][$1] = $2; }\r\n    });\r\n\r\n    return uri;\r\n  },\r\n\r\n  parseOptions: {\r\n    strictMode: false,\r\n    key: ['source','protocol','authority','userInfo','user','password','host','port','relative','path','directory','file','query','anchor'],\r\n    q: {\r\n      name:   'queryKey',\r\n      parser: /(?:^|&)([^&=]*)=?([^&]*)/g\r\n    },\r\n    parser: {\r\n      strict: /^(?:([^:\\/?#]+):)?(?:\\/\\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\\/?#]*)(?::(\\d*))?))?((((?:[^?#\\/]*\\/)*)([^?#]*))(?:\\?([^#]*))?(?:#(.*))?)/,\r\n      loose:  /^(?:(?![^:@]+:[^:@\\/]*@)([^:\\/?#.]+):)?(?:\\/\\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\\/?#]*)(?::(\\d*))?)(((\\/(?:[^?#](?![^?#\\/]*\\.[^?#\\/.]+(?:[?#]|$)))*\\/?)?([^?#\\/]*))(?:\\?([^#]*))?(?:#(.*))?)/\r\n    }\r\n  },\r\n\r\n  getParam: function(custom_params) {\r\n    var query_string = {},\r\n        query = custom_params ? custom_params : window.location.search.substring(1),\r\n        vars = query.split('&');\r\n\r\n    for (var i = 0; i < vars.length; i++) {\r\n      var pair = vars[i].split('=');\r\n      if (typeof query_string[pair[0]] === 'undefined') {\r\n        query_string[pair[0]] = pair[1];\r\n      } else if (typeof query_string[pair[0]] === 'string') {\r\n        var arr = [ query_string[pair[0]], pair[1] ];\r\n        query_string[pair[0]] = arr;\r\n      } else {\r\n        query_string[pair[0]].push(pair[1]);\r\n      }\r\n    }\r\n    return query_string;\r\n  },\r\n\r\n  getHost: function(request) {\r\n    return this.parse(request).host.replace('www.', '');\r\n  }\r\n\r\n};\n},{}],\"/mnt/d/Work/SKBLAB/sourcebuster-js/src/js/helpers/utils.js\":[function(_dereq_,module,exports){\n\"use strict\";\r\n\r\nmodule.exports = {\r\n\r\n  escapeRegexp: function(string) {\r\n    return string.replace(/[\\-\\[\\]\\/\\{\\}\\(\\)\\*\\+\\?\\.\\\\\\^\\$\\|]/g, \"\\\\$&\");\r\n  },\r\n\r\n  setDate: function(date, offset) {\r\n    var utc_offset    = date.getTimezoneOffset() / 60,\r\n        now_hours     = date.getHours(),\r\n        custom_offset = offset || offset === 0 ? offset : -utc_offset;\r\n\r\n    date.setHours(now_hours + utc_offset + custom_offset);\r\n\r\n    var year    = date.getFullYear(),\r\n        month   = this.setLeadingZeroToInt(date.getMonth() + 1,   2),\r\n        day     = this.setLeadingZeroToInt(date.getDate(),        2),\r\n        hour    = this.setLeadingZeroToInt(date.getHours(),       2),\r\n        minute  = this.setLeadingZeroToInt(date.getMinutes(),     2),\r\n        second  = this.setLeadingZeroToInt(date.getSeconds(),     2);\r\n\r\n    return (year + '-' + month + '-' + day + ' ' + hour + ':' + minute + ':' + second);\r\n  },\r\n\r\n  setLeadingZeroToInt: function(num, size) {\r\n    var s = num + '';\r\n    while (s.length < size) { s = '0' + s; }\r\n    return s;\r\n  },\r\n\r\n  randomInt: function(min, max) {\r\n    return Math.floor(Math.random() * (max - min + 1)) + min;\r\n  }\r\n\r\n};\r\n\n},{}],\"/mnt/d/Work/SKBLAB/sourcebuster-js/src/js/init.js\":[function(_dereq_,module,exports){\n\"use strict\";\r\n\r\nvar data        = _dereq_('./data'),\r\n    terms       = _dereq_('./terms'),\r\n    cookies     = _dereq_('./helpers/cookies'),\r\n    uri         = _dereq_('./helpers/uri'),\r\n    utils       = _dereq_('./helpers/utils'),\r\n    params      = _dereq_('./params'),\r\n    migrations  = _dereq_('./migrations');\r\n\r\nvar blacklist = ['partner', 'office', 'agent'];\r\n\r\nmodule.exports = function(prefs) {\r\n\r\n  var p         = params.fetch(prefs);\r\n  var get_param = uri.getParam();\r\n  var domain    = p.domain.host,\r\n      isolate   = p.domain.isolate,\r\n      lifetime  = p.lifetime;\r\n\r\n  migrations.go(lifetime, domain, isolate);\r\n\r\n  var __sbjs_type,\r\n      __sbjs_source,\r\n      __sbjs_medium,\r\n      __sbjs_campaign,\r\n      __sbjs_content,\r\n      __sbjs_term;\r\n\r\n  function mainData() {\r\n    var sbjs_data;\r\n    if (\r\n        typeof get_param.utm_source        !== 'undefined' ||\r\n        typeof get_param.utm_medium        !== 'undefined' ||\r\n        typeof get_param.utm_campaign      !== 'undefined' ||\r\n        typeof get_param.utm_content       !== 'undefined' ||\r\n        typeof get_param.utm_term          !== 'undefined' ||\r\n        typeof get_param.gclid             !== 'undefined' ||\r\n        typeof get_param.yclid             !== 'undefined' ||\r\n        typeof get_param[p.campaign_param] !== 'undefined' ||\r\n        typeof get_param[p.term_param]     !== 'undefined' ||\r\n        typeof get_param[p.content_param]  !== 'undefined'\r\n    ) {\r\n      setFirstAndCurrentExtraData();\r\n      sbjs_data = getData(terms.traffic.utm);\r\n    } else if (checkReferer(terms.traffic.organic)) {\r\n      setFirstAndCurrentExtraData();\r\n      sbjs_data = getData(terms.traffic.organic);\r\n    } else if (!cookies.get(data.containers.session) && checkReferer(terms.traffic.referral)) {\r\n      setFirstAndCurrentExtraData();\r\n      sbjs_data = getData(terms.traffic.referral);\r\n    } else if (!cookies.get(data.containers.first) && !cookies.get(data.containers.current)) {\r\n      setFirstAndCurrentExtraData();\r\n      sbjs_data = getData(terms.traffic.typein);\r\n    } else {\r\n      return cookies.get(data.containers.current);\r\n    }\r\n\r\n    return sbjs_data;\r\n  }\r\n\r\n  function getData(type) {\r\n\r\n    switch (type) {\r\n\r\n      case terms.traffic.utm:\r\n\r\n        __sbjs_type = terms.traffic.utm;\r\n\r\n        if (typeof get_param.utm_source !== 'undefined') {\r\n          __sbjs_source = get_param.utm_source;\r\n        } else if (typeof get_param.gclid !== 'undefined') {\r\n          __sbjs_source = 'google';\r\n        } else if (typeof get_param.yclid !== 'undefined') {\r\n          __sbjs_source = 'yandex';  \r\n        } else {\r\n          __sbjs_source = terms.none;\r\n        }\r\n\r\n        if (typeof get_param.utm_medium !== 'undefined') {\r\n          __sbjs_medium = get_param.utm_medium;\r\n        } else if (typeof get_param.gclid !== 'undefined') {\r\n          __sbjs_medium = 'cpc';\r\n        } else if (typeof get_param.yclid !== 'undefined') {\r\n          __sbjs_medium = 'cpc';  \r\n        } else {\r\n          __sbjs_medium = terms.none;\r\n        }\r\n\r\n        if (typeof get_param.utm_campaign !== 'undefined') {\r\n          __sbjs_campaign = get_param.utm_campaign;\r\n        } else if (typeof get_param[p.campaign_param] !== 'undefined') {\r\n          __sbjs_campaign = get_param[p.campaign_param];\r\n        } else if (typeof get_param.gclid !== 'undefined') {\r\n          __sbjs_campaign = 'google_cpc';\r\n        } else if (typeof get_param.yclid !== 'undefined') {\r\n          __sbjs_campaign = 'yandex_cpc';  \r\n        } else {\r\n          __sbjs_campaign = terms.none;\r\n        }\r\n\r\n        if (typeof get_param.utm_content !== 'undefined') {\r\n          __sbjs_content = get_param.utm_content;\r\n        } else if (typeof get_param[p.content_param] !== 'undefined') {\r\n          __sbjs_content = get_param[p.content_param];\r\n        } else {\r\n          __sbjs_content = terms.none;\r\n        }\r\n\r\n        if (typeof get_param.utm_term !== 'undefined') {\r\n          __sbjs_term = get_param.utm_term;\r\n        } else if (typeof get_param[p.term_param] !== 'undefined') {\r\n          __sbjs_term = get_param[p.term_param];\r\n        } else {\r\n          __sbjs_term = getUtmTerm() || terms.none;\r\n        }\r\n\r\n        break;\r\n\r\n      case terms.traffic.organic:\r\n        __sbjs_type     = terms.traffic.organic;\r\n        __sbjs_source   = __sbjs_source || uri.getHost(document.referrer);\r\n        __sbjs_medium   = terms.referer.organic;\r\n        __sbjs_campaign = terms.none;\r\n        __sbjs_content  = terms.none;\r\n        __sbjs_term     = terms.none;\r\n        break;\r\n\r\n      case terms.traffic.referral:\r\n        __sbjs_type     = terms.traffic.referral;\r\n        __sbjs_source   = __sbjs_source || uri.getHost(document.referrer);\r\n        __sbjs_medium   = __sbjs_medium || terms.referer.referral;\r\n        __sbjs_campaign = terms.none;\r\n        __sbjs_content  = uri.parse(document.referrer).path;\r\n        __sbjs_term     = terms.none;\r\n        break;\r\n\r\n      case terms.traffic.typein:\r\n        __sbjs_type     = terms.traffic.typein;\r\n        __sbjs_source   = p.typein_attributes.source;\r\n        __sbjs_medium   = p.typein_attributes.medium;\r\n        __sbjs_campaign = terms.none;\r\n        __sbjs_content  = terms.none;\r\n        __sbjs_term     = terms.none;\r\n        break;\r\n\r\n      default:\r\n        __sbjs_type     = terms.oops;\r\n        __sbjs_source   = terms.oops;\r\n        __sbjs_medium   = terms.oops;\r\n        __sbjs_campaign = terms.oops;\r\n        __sbjs_content  = terms.oops;\r\n        __sbjs_term     = terms.oops;\r\n    }\r\n    var sbjs_data = {\r\n      type:             __sbjs_type,\r\n      source:           __sbjs_source,\r\n      medium:           __sbjs_medium,\r\n      campaign:         __sbjs_campaign,\r\n      content:          __sbjs_content,\r\n      term:             __sbjs_term\r\n    };\r\n\r\n    return data.pack.main(sbjs_data);\r\n\r\n  }\r\n\r\n  function getUtmTerm() {\r\n    var referer = document.referrer;\r\n    if (get_param.utm_term) {\r\n      return get_param.utm_term;\r\n    } else if (referer && uri.parse(referer).host && uri.parse(referer).host.match(/^(?:.*\\.)?yandex\\..{2,9}$/i)) {\r\n      try {\r\n        return uri.getParam(uri.parse(document.referrer).query).text;\r\n      } catch (err) {\r\n        return false;\r\n      }\r\n    } else {\r\n      return false;\r\n    }\r\n  }\r\n\r\n  function checkReferer(type) {\r\n    var referer = document.referrer;\r\n    switch(type) {\r\n      case terms.traffic.organic:\r\n        return (!!referer && checkRefererHost(referer) && isOrganic(referer));\r\n      case terms.traffic.referral:\r\n        return (!!referer && checkRefererHost(referer) && isReferral(referer));\r\n      default:\r\n        return false;\r\n    }\r\n  }\r\n\r\n  function checkRefererHost(referer) {\r\n    if (p.domain) {\r\n      if (!isolate) {\r\n        var host_regex = new RegExp('^(?:.*\\\\.)?' + utils.escapeRegexp(domain) + '$', 'i');\r\n        return !(uri.getHost(referer).match(host_regex));\r\n      } else {\r\n        return (uri.getHost(referer) !== uri.getHost(domain));\r\n      }\r\n    } else {\r\n      return (uri.getHost(referer) !== uri.getHost(document.location.href));\r\n    }\r\n  }\r\n\r\n  function isOrganic(referer) {\r\n\r\n    var y_host  = 'yandex',\r\n        y_param = 'text',\r\n        g_host  = 'google';\r\n\r\n    var y_host_regex  = new RegExp('^(?:.*\\\\.)?'  + utils.escapeRegexp(y_host)  + '\\\\..{2,9}$'),\r\n        y_param_regex = new RegExp('.*'           + utils.escapeRegexp(y_param) + '=.*'),\r\n        g_host_regex  = new RegExp('^(?:www\\\\.)?' + utils.escapeRegexp(g_host)  + '\\\\..{2,9}$');\r\n\r\n    if (\r\n        !!uri.parse(referer).query &&\r\n        !!uri.parse(referer).host.match(y_host_regex) &&\r\n        !!uri.parse(referer).query.match(y_param_regex)\r\n      ) {\r\n      __sbjs_source = y_host;\r\n      return true;\r\n    } else if (!!uri.parse(referer).host.match(g_host_regex)) {\r\n      __sbjs_source = g_host;\r\n      return true;\r\n    } else if (!!uri.parse(referer).query) {\r\n      for (var i = 0; i < p.organics.length; i++) {\r\n        if (\r\n            uri.parse(referer).host.match(new RegExp('^(?:.*\\\\.)?' + utils.escapeRegexp(p.organics[i].host)  + '$', 'i')) &&\r\n            uri.parse(referer).query.match(new RegExp('.*'         + utils.escapeRegexp(p.organics[i].param) + '=.*', 'i'))\r\n          ) {\r\n          __sbjs_source = p.organics[i].display || p.organics[i].host;\r\n          return true;\r\n        }\r\n        if (i + 1 === p.organics.length) {\r\n          return false;\r\n        }\r\n      }\r\n    } else {\r\n      return false;\r\n    }\r\n  }\r\n\r\n  function isReferral(referer) {\r\n    if (p.referrals.length > 0) {\r\n      for (var i = 0; i < p.referrals.length; i++) {\r\n        if (uri.parse(referer).host.match(new RegExp('^(?:.*\\\\.)?' + utils.escapeRegexp(p.referrals[i].host) + '$', 'i'))) {\r\n          __sbjs_source = p.referrals[i].display  || p.referrals[i].host;\r\n          __sbjs_medium = p.referrals[i].medium   || terms.referer.referral;\r\n          return true;\r\n        }\r\n        if (i + 1 === p.referrals.length) {\r\n          __sbjs_source = uri.getHost(referer);\r\n          return true;\r\n        }\r\n      }\r\n    } else {\r\n      __sbjs_source = uri.getHost(referer);\r\n      return true;\r\n    }\r\n  }\r\n\r\n  function setFirstAndCurrentExtraData() {\r\n    cookies.set(data.containers.current_extra, data.pack.extra(p.timezone_offset), lifetime, domain, isolate);\r\n    if (!cookies.get(data.containers.first_extra)) {\r\n      cookies.set(data.containers.first_extra, data.pack.extra(p.timezone_offset), lifetime, domain, isolate);\r\n    }\r\n  }\r\n\r\n  (function setData() {\r\n\r\n    if (get_param.ldg && blacklist.includes(get_param.ldg)) {\r\n      // destroy sourcebuster cookies on blacklist\r\n      Object.values(data.containers).map(function(cookie) {\r\n        cookies.destroy(cookie, domain, isolate);\r\n      });\r\n      return;\r\n    }\r\n    // Main data\r\n    cookies.set(data.containers.current, mainData(), lifetime, domain, isolate);\r\n    if (!cookies.get(data.containers.first)) {\r\n      cookies.set(data.containers.first, cookies.get(data.containers.current), lifetime, domain, isolate);\r\n    }\r\n\r\n    // User data\r\n    var visits, udata;\r\n    if (!cookies.get(data.containers.udata)) {\r\n      visits  = 1;\r\n      udata   = data.pack.user(visits, p.user_ip);\r\n    } else {\r\n      visits  = parseInt(cookies.parse(data.containers.udata)[cookies.unsbjs(data.containers.udata)][data.aliases.udata.visits]) || 1;\r\n      visits  = cookies.get(data.containers.session) ? visits : visits + 1;\r\n      udata   = data.pack.user(visits, p.user_ip);\r\n    }\r\n    cookies.set(data.containers.udata, udata, lifetime, domain, isolate);\r\n\r\n    // Session\r\n    var pages_count;\r\n    if (!cookies.get(data.containers.session)) {\r\n      pages_count = 1;\r\n    } else {\r\n      pages_count = parseInt(cookies.parse(data.containers.session)[cookies.unsbjs(data.containers.session)][data.aliases.session.pages_seen]) || 1;\r\n      pages_count += 1;\r\n    }\r\n    console.log('data.containers.session', data.containers.session);\r\n    cookies.set(data.containers.session, data.pack.session(pages_count), p.session_length, domain, isolate);\r\n\r\n    // Promocode\r\n    if (p.promocode && !cookies.get(data.containers.promocode)) {\r\n      cookies.set(data.containers.promocode, data.pack.promo(p.promocode), lifetime, domain, isolate);\r\n    }\r\n\r\n  })();\r\n\r\n  return cookies.parse(data.containers);\r\n\r\n};\n},{\"./data\":\"/mnt/d/Work/SKBLAB/sourcebuster-js/src/js/data.js\",\"./helpers/cookies\":\"/mnt/d/Work/SKBLAB/sourcebuster-js/src/js/helpers/cookies.js\",\"./helpers/uri\":\"/mnt/d/Work/SKBLAB/sourcebuster-js/src/js/helpers/uri.js\",\"./helpers/utils\":\"/mnt/d/Work/SKBLAB/sourcebuster-js/src/js/helpers/utils.js\",\"./migrations\":\"/mnt/d/Work/SKBLAB/sourcebuster-js/src/js/migrations.js\",\"./params\":\"/mnt/d/Work/SKBLAB/sourcebuster-js/src/js/params.js\",\"./terms\":\"/mnt/d/Work/SKBLAB/sourcebuster-js/src/js/terms.js\"}],\"/mnt/d/Work/SKBLAB/sourcebuster-js/src/js/migrations.js\":[function(_dereq_,module,exports){\n\"use strict\";\r\n\r\nvar data    = _dereq_('./data'),\r\n    cookies = _dereq_('./helpers/cookies');\r\n\r\nmodule.exports = {\r\n\r\n  go: function(lifetime, domain, isolate) {\r\n\r\n    var migrate = this.migrations,\r\n        _with   = { l: lifetime, d: domain, i: isolate };\r\n\r\n    var i;\r\n\r\n    if (!cookies.get(data.containers.first) && !cookies.get(data.service.migrations)) {\r\n\r\n      var mids = [];\r\n      for (i = 0; i < migrate.length; i++) { mids.push(migrate[i].id); }\r\n\r\n      var advance = '';\r\n      for (i = 0; i < mids.length; i++) {\r\n        advance += mids[i] + '=1';\r\n        if (i < mids.length - 1) { advance += data.delimiter; }\r\n      }\r\n      cookies.set(data.service.migrations, advance, _with.l, _with.d, _with.i);\r\n\r\n    } else if (!cookies.get(data.service.migrations)) {\r\n\r\n      // We have only one migration for now, so just\r\n      for (i = 0; i < migrate.length; i++) {\r\n        migrate[i].go(migrate[i].id, _with);\r\n      }\r\n\r\n    }\r\n\r\n  },\r\n\r\n  migrations: [\r\n\r\n    {\r\n      id: '1418474375998',\r\n      version: '1.0.0-beta',\r\n      go: function(mid, _with) {\r\n\r\n        var success = mid + '=1',\r\n            fail    = mid + '=0';\r\n\r\n        var safeReplace = function($0, $1, $2) {\r\n          return ($1 || $2 ? $0 : data.delimiter);\r\n        };\r\n\r\n        try {\r\n\r\n          // Switch delimiter and renew cookies\r\n          var _in = [];\r\n          for (var prop in data.containers) {\r\n            if (data.containers.hasOwnProperty(prop)) {\r\n              _in.push(data.containers[prop]);\r\n            }\r\n          }\r\n\r\n          for (var i = 0; i < _in.length; i++) {\r\n            if (cookies.get(_in[i])) {\r\n              var buffer = cookies.get(_in[i]).replace(/(\\|)?\\|(\\|)?/g, safeReplace);\r\n              cookies.destroy(_in[i], _with.d, _with.i);\r\n              cookies.destroy(_in[i], _with.d, !_with.i);\r\n              cookies.set(_in[i], buffer, _with.l, _with.d, _with.i);\r\n            }\r\n          }\r\n\r\n          // Update `session`\r\n          if (cookies.get(data.containers.session)) {\r\n            cookies.set(data.containers.session, data.pack.session(0), _with.l, _with.d, _with.i);\r\n          }\r\n\r\n          // Yay!\r\n          cookies.set(data.service.migrations, success, _with.l, _with.d, _with.i);\r\n\r\n        } catch (err) {\r\n          // Oops\r\n          cookies.set(data.service.migrations, fail, _with.l, _with.d, _with.i);\r\n        }\r\n      }\r\n    }\r\n\r\n  ]\r\n\r\n};\n},{\"./data\":\"/mnt/d/Work/SKBLAB/sourcebuster-js/src/js/data.js\",\"./helpers/cookies\":\"/mnt/d/Work/SKBLAB/sourcebuster-js/src/js/helpers/cookies.js\"}],\"/mnt/d/Work/SKBLAB/sourcebuster-js/src/js/params.js\":[function(_dereq_,module,exports){\n\"use strict\";\r\n\r\nvar terms = _dereq_('./terms'),\r\n    uri   = _dereq_('./helpers/uri');\r\n\r\nmodule.exports = {\r\n\r\n  fetch: function(prefs) {\r\n\r\n    var user   = prefs || {},\r\n        params = {};\r\n\r\n    // Set `lifetime of the cookie` in months\r\n    params.lifetime = this.validate.checkFloat(user.lifetime) || 6;\r\n    params.lifetime = parseInt(params.lifetime * 30 * 24 * 60);\r\n\r\n    // Set `session length` in minutes\r\n    params.session_length = this.validate.checkInt(user.session_length) || 30;\r\n\r\n    // Set `timezone offset` in hours\r\n    params.timezone_offset = this.validate.checkInt(user.timezone_offset);\r\n\r\n    // Set `campaign param` for AdWords links\r\n    params.campaign_param = user.campaign_param || false;\r\n\r\n    // Set `term param` and `content param` for AdWords links\r\n    params.term_param = user.term_param || false;\r\n    params.content_param = user.content_param || false;\r\n\r\n    // Set `user ip`\r\n    params.user_ip = user.user_ip || terms.none;\r\n\r\n    // Set `promocode`\r\n    if (user.promocode) {\r\n      params.promocode = {};\r\n      params.promocode.min = parseInt(user.promocode.min) || 100000;\r\n      params.promocode.max = parseInt(user.promocode.max) || 999999;\r\n    } else {\r\n      params.promocode = false;\r\n    }\r\n\r\n    // Set `typein attributes`\r\n    if (user.typein_attributes && user.typein_attributes.source && user.typein_attributes.medium) {\r\n      params.typein_attributes = {};\r\n      params.typein_attributes.source = user.typein_attributes.source;\r\n      params.typein_attributes.medium = user.typein_attributes.medium;\r\n    } else {\r\n      params.typein_attributes = { source: '(direct)', medium: '(none)' };\r\n    }\r\n\r\n    // Set `domain`\r\n    if (user.domain && this.validate.isString(user.domain)) {\r\n      params.domain = { host: user.domain, isolate: false };\r\n    } else if (user.domain && user.domain.host) {\r\n      params.domain = user.domain;\r\n    } else {\r\n      params.domain = { host: uri.getHost(document.location.hostname), isolate: false };\r\n    }\r\n\r\n    // Set `referral sources`\r\n    params.referrals = [];\r\n\r\n    if (user.referrals && user.referrals.length > 0) {\r\n      for (var ir = 0; ir < user.referrals.length; ir++) {\r\n        if (user.referrals[ir].host) {\r\n          params.referrals.push(user.referrals[ir]);\r\n        }\r\n      }\r\n    }\r\n\r\n    // Set `organic sources`\r\n    params.organics = [];\r\n\r\n    if (user.organics && user.organics.length > 0) {\r\n      for (var io = 0; io < user.organics.length; io++) {\r\n        if (user.organics[io].host && user.organics[io].param) {\r\n          params.organics.push(user.organics[io]);\r\n        }\r\n      }\r\n    }\r\n\r\n    params.organics.push({ host: 'bing.com',      param: 'q',     display: 'bing'            });\r\n    params.organics.push({ host: 'yahoo.com',     param: 'p',     display: 'yahoo'           });\r\n    params.organics.push({ host: 'about.com',     param: 'q',     display: 'about'           });\r\n    params.organics.push({ host: 'aol.com',       param: 'q',     display: 'aol'             });\r\n    params.organics.push({ host: 'ask.com',       param: 'q',     display: 'ask'             });\r\n    params.organics.push({ host: 'globososo.com', param: 'q',     display: 'globo'           });\r\n    params.organics.push({ host: 'go.mail.ru',    param: 'q',     display: 'go.mail.ru'      });\r\n    params.organics.push({ host: 'rambler.ru',    param: 'query', display: 'rambler'         });\r\n    params.organics.push({ host: 'tut.by',        param: 'query', display: 'tut.by'          });\r\n\r\n    params.referrals.push({ host: 't.co',                         display: 'twitter.com'     });\r\n    params.referrals.push({ host: 'plus.url.google.com',          display: 'plus.google.com' });\r\n\r\n\r\n    return params;\r\n\r\n  },\r\n\r\n  validate: {\r\n\r\n    checkFloat: function(v) {\r\n      return v && this.isNumeric(parseFloat(v)) ? parseFloat(v) : false;\r\n    },\r\n\r\n    checkInt: function(v) {\r\n      return v && this.isNumeric(parseInt(v)) ? parseInt(v) : false;\r\n    },\r\n\r\n    isNumeric: function(v){\r\n      return !isNaN(v);\r\n    },\r\n\r\n    isString: function(v) {\r\n      return Object.prototype.toString.call(v) === '[object String]';\r\n    }\r\n\r\n  }\r\n\r\n};\n},{\"./helpers/uri\":\"/mnt/d/Work/SKBLAB/sourcebuster-js/src/js/helpers/uri.js\",\"./terms\":\"/mnt/d/Work/SKBLAB/sourcebuster-js/src/js/terms.js\"}],\"/mnt/d/Work/SKBLAB/sourcebuster-js/src/js/terms.js\":[function(_dereq_,module,exports){\n\"use strict\";\r\n\r\nmodule.exports = {\r\n\r\n  traffic: {\r\n    utm:        'utm',\r\n    organic:    'organic',\r\n    referral:   'referral',\r\n    typein:     'typein'\r\n  },\r\n\r\n  referer: {\r\n    referral:   'referral',\r\n    organic:    'organic',\r\n    social:     'social'\r\n  },\r\n\r\n  none:         '(none)',\r\n  oops:         '(Houston, we have a problem)'\r\n\r\n};\r\n\n},{}]},{},[\"./src/js/sourcebuster.js\"])(\"./src/js/sourcebuster.js\")\n});\n\n","\"use strict\";\r\n\r\nvar terms = require('./terms'),\r\n    utils = require('./helpers/utils');\r\n\r\nvar data = {\r\n\r\n  containers: {\r\n    current:          'sbjs_current',\r\n    current_extra:    'sbjs_current_add',\r\n    first:            'sbjs_first',\r\n    first_extra:      'sbjs_first_add',\r\n    session:          'sbjs_session',\r\n    udata:            'sbjs_udata',\r\n    promocode:        'sbjs_promo'\r\n  },\r\n\r\n  service: {\r\n    migrations:       'sbjs_migrations'\r\n  },\r\n\r\n  delimiter:          '|||',\r\n\r\n  aliases: {\r\n\r\n    main: {\r\n      type:           'typ',\r\n      source:         'src',\r\n      medium:         'mdm',\r\n      campaign:       'cmp',\r\n      content:        'cnt',\r\n      term:           'trm'\r\n    },\r\n\r\n    extra: {\r\n      fire_date:      'fd',\r\n      entrance_point: 'ep',\r\n      referer:        'rf'\r\n    },\r\n\r\n    session: {\r\n      pages_seen:     'pgs',\r\n      current_page:   'cpg'\r\n    },\r\n\r\n    udata: {\r\n      visits:         'vst',\r\n      ip:             'uip',\r\n      agent:          'uag'\r\n    },\r\n\r\n    promo:            'code'\r\n\r\n  },\r\n\r\n  pack: {\r\n\r\n    main: function(sbjs) {\r\n      return (\r\n        data.aliases.main.type      + '=' + sbjs.type     + data.delimiter +\r\n        data.aliases.main.source    + '=' + sbjs.source   + data.delimiter +\r\n        data.aliases.main.medium    + '=' + sbjs.medium   + data.delimiter +\r\n        data.aliases.main.campaign  + '=' + sbjs.campaign + data.delimiter +\r\n        data.aliases.main.content   + '=' + sbjs.content  + data.delimiter +\r\n        data.aliases.main.term      + '=' + sbjs.term\r\n      );\r\n    },\r\n\r\n    extra: function(timezone_offset) {\r\n      return (\r\n        data.aliases.extra.fire_date      + '=' + utils.setDate(new Date, timezone_offset) + data.delimiter +\r\n        data.aliases.extra.entrance_point + '=' + document.location.href                   + data.delimiter +\r\n        data.aliases.extra.referer        + '=' + (document.referrer || terms.none)\r\n      );\r\n    },\r\n\r\n    user: function(visits, user_ip) {\r\n      return (\r\n        data.aliases.udata.visits + '=' + visits  + data.delimiter +\r\n        data.aliases.udata.ip     + '=' + user_ip + data.delimiter +\r\n        data.aliases.udata.agent  + '=' + navigator.userAgent\r\n      );\r\n    },\r\n\r\n    session: function(pages) {\r\n      return (\r\n      data.aliases.session.pages_seen   + '=' + pages + data.delimiter +\r\n      data.aliases.session.current_page + '=' + document.location.href\r\n      );\r\n    },\r\n\r\n    promo: function(promo) {\r\n      return (\r\n        data.aliases.promo + '=' + utils.setLeadingZeroToInt(utils.randomInt(promo.min, promo.max), promo.max.toString().length)\r\n      );\r\n    }\r\n\r\n  }\r\n};\r\n\r\nmodule.exports = data;","\"use strict\";\r\n\r\nvar delimiter = require('../data').delimiter;\r\n\r\nmodule.exports = {\r\n\r\n  encodeData: function(s) {\r\n    return encodeURIComponent(s).replace(/\\!/g, '%21')\r\n                                .replace(/\\~/g, '%7E')\r\n                                .replace(/\\*/g, '%2A')\r\n                                .replace(/\\'/g, '%27')\r\n                                .replace(/\\(/g, '%28')\r\n                                .replace(/\\)/g, '%29');\r\n  },\r\n\r\n  decodeData: function(s) {\r\n    try {\r\n      return decodeURIComponent(s).replace(/\\%21/g, '!')\r\n                                  .replace(/\\%7E/g, '~')\r\n                                  .replace(/\\%2A/g, '*')\r\n                                  .replace(/\\%27/g, \"'\")\r\n                                  .replace(/\\%28/g, '(')\r\n                                  .replace(/\\%29/g, ')');\r\n    } catch(err1) {\r\n      // try unescape for backward compatibility\r\n      try { return unescape(s); } catch(err2) { return ''; }\r\n    }\r\n  },\r\n\r\n  set: function(name, value, minutes, domain, excl_subdomains) {\r\n    var expires, basehost;\r\n\r\n    if (minutes) {\r\n      var date = new Date();\r\n      date.setTime(date.getTime() + (minutes * 60 * 1000));\r\n      expires = '; expires=' + date.toGMTString();\r\n    } else {\r\n      expires = '';\r\n    }\r\n    if (domain && !excl_subdomains) {\r\n      basehost = ';domain=.' + domain;\r\n    } else {\r\n      basehost = '';\r\n    }\r\n    document.cookie = this.encodeData(name) + '=' + this.encodeData(value) + expires + basehost + '; path=/';\r\n  },\r\n\r\n  get: function(name) {\r\n    var nameEQ = this.encodeData(name) + '=',\r\n        ca = document.cookie.split(';');\r\n\r\n    for (var i = 0; i < ca.length; i++) {\r\n      var c = ca[i];\r\n      while (c.charAt(0) === ' ') { c = c.substring(1, c.length); }\r\n      if (c.indexOf(nameEQ) === 0) {\r\n        return this.decodeData(c.substring(nameEQ.length, c.length));\r\n      }\r\n    }\r\n    return null;\r\n  },\r\n\r\n  destroy: function(name, domain, excl_subdomains) {\r\n    console.log('name', name);\r\n    console.log('domain', domain);\r\n    console.log('excl_subdomains', excl_subdomains);\r\n    this.set(name, '', -1, domain, excl_subdomains);\r\n  },\r\n\r\n  parse: function(yummy) {\r\n\r\n    var cookies = [],\r\n        data    = {};\r\n\r\n    if (typeof yummy === 'string') {\r\n      cookies.push(yummy);\r\n    } else {\r\n      for (var prop in yummy) {\r\n        if (yummy.hasOwnProperty(prop)) {\r\n          cookies.push(yummy[prop]);\r\n        }\r\n      }\r\n    }\r\n\r\n    for (var i1 = 0; i1 < cookies.length; i1++) {\r\n      var cookie_array;\r\n      data[this.unsbjs(cookies[i1])] = {};\r\n      if (this.get(cookies[i1])) {\r\n        cookie_array = this.get(cookies[i1]).split(delimiter);\r\n      } else {\r\n        cookie_array = [];\r\n      }\r\n      for (var i2 = 0; i2 < cookie_array.length; i2++) {\r\n        var tmp_array = cookie_array[i2].split('='),\r\n            result_array = tmp_array.splice(0, 1);\r\n        result_array.push(tmp_array.join('='));\r\n        data[this.unsbjs(cookies[i1])][result_array[0]] = this.decodeData(result_array[1]);\r\n      }\r\n    }\r\n\r\n    return data;\r\n\r\n  },\r\n\r\n  unsbjs: function (string) {\r\n    return string.replace('sbjs_', '');\r\n  }\r\n\r\n};\r\n","\"use strict\";\r\n\r\nmodule.exports = {\r\n\r\n  parse: function(str) {\r\n    var o = this.parseOptions,\r\n        m = o.parser[o.strictMode ? 'strict' : 'loose'].exec(str),\r\n        uri = {},\r\n        i = 14;\r\n\r\n    while (i--) { uri[o.key[i]] = m[i] || ''; }\r\n\r\n    uri[o.q.name] = {};\r\n    uri[o.key[12]].replace(o.q.parser, function ($0, $1, $2) {\r\n      if ($1) { uri[o.q.name][$1] = $2; }\r\n    });\r\n\r\n    return uri;\r\n  },\r\n\r\n  parseOptions: {\r\n    strictMode: false,\r\n    key: ['source','protocol','authority','userInfo','user','password','host','port','relative','path','directory','file','query','anchor'],\r\n    q: {\r\n      name:   'queryKey',\r\n      parser: /(?:^|&)([^&=]*)=?([^&]*)/g\r\n    },\r\n    parser: {\r\n      strict: /^(?:([^:\\/?#]+):)?(?:\\/\\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\\/?#]*)(?::(\\d*))?))?((((?:[^?#\\/]*\\/)*)([^?#]*))(?:\\?([^#]*))?(?:#(.*))?)/,\r\n      loose:  /^(?:(?![^:@]+:[^:@\\/]*@)([^:\\/?#.]+):)?(?:\\/\\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\\/?#]*)(?::(\\d*))?)(((\\/(?:[^?#](?![^?#\\/]*\\.[^?#\\/.]+(?:[?#]|$)))*\\/?)?([^?#\\/]*))(?:\\?([^#]*))?(?:#(.*))?)/\r\n    }\r\n  },\r\n\r\n  getParam: function(custom_params) {\r\n    var query_string = {},\r\n        query = custom_params ? custom_params : window.location.search.substring(1),\r\n        vars = query.split('&');\r\n\r\n    for (var i = 0; i < vars.length; i++) {\r\n      var pair = vars[i].split('=');\r\n      if (typeof query_string[pair[0]] === 'undefined') {\r\n        query_string[pair[0]] = pair[1];\r\n      } else if (typeof query_string[pair[0]] === 'string') {\r\n        var arr = [ query_string[pair[0]], pair[1] ];\r\n        query_string[pair[0]] = arr;\r\n      } else {\r\n        query_string[pair[0]].push(pair[1]);\r\n      }\r\n    }\r\n    return query_string;\r\n  },\r\n\r\n  getHost: function(request) {\r\n    return this.parse(request).host.replace('www.', '');\r\n  }\r\n\r\n};","\"use strict\";\r\n\r\nmodule.exports = {\r\n\r\n  escapeRegexp: function(string) {\r\n    return string.replace(/[\\-\\[\\]\\/\\{\\}\\(\\)\\*\\+\\?\\.\\\\\\^\\$\\|]/g, \"\\\\$&\");\r\n  },\r\n\r\n  setDate: function(date, offset) {\r\n    var utc_offset    = date.getTimezoneOffset() / 60,\r\n        now_hours     = date.getHours(),\r\n        custom_offset = offset || offset === 0 ? offset : -utc_offset;\r\n\r\n    date.setHours(now_hours + utc_offset + custom_offset);\r\n\r\n    var year    = date.getFullYear(),\r\n        month   = this.setLeadingZeroToInt(date.getMonth() + 1,   2),\r\n        day     = this.setLeadingZeroToInt(date.getDate(),        2),\r\n        hour    = this.setLeadingZeroToInt(date.getHours(),       2),\r\n        minute  = this.setLeadingZeroToInt(date.getMinutes(),     2),\r\n        second  = this.setLeadingZeroToInt(date.getSeconds(),     2);\r\n\r\n    return (year + '-' + month + '-' + day + ' ' + hour + ':' + minute + ':' + second);\r\n  },\r\n\r\n  setLeadingZeroToInt: function(num, size) {\r\n    var s = num + '';\r\n    while (s.length < size) { s = '0' + s; }\r\n    return s;\r\n  },\r\n\r\n  randomInt: function(min, max) {\r\n    return Math.floor(Math.random() * (max - min + 1)) + min;\r\n  }\r\n\r\n};\r\n","\"use strict\";\r\n\r\nvar data        = require('./data'),\r\n    terms       = require('./terms'),\r\n    cookies     = require('./helpers/cookies'),\r\n    uri         = require('./helpers/uri'),\r\n    utils       = require('./helpers/utils'),\r\n    params      = require('./params'),\r\n    migrations  = require('./migrations');\r\n\r\nvar blacklist = ['partner', 'office', 'agent'];\r\n\r\nmodule.exports = function(prefs) {\r\n\r\n  var p         = params.fetch(prefs);\r\n  var get_param = uri.getParam();\r\n  var domain    = p.domain.host,\r\n      isolate   = p.domain.isolate,\r\n      lifetime  = p.lifetime;\r\n\r\n  migrations.go(lifetime, domain, isolate);\r\n\r\n  var __sbjs_type,\r\n      __sbjs_source,\r\n      __sbjs_medium,\r\n      __sbjs_campaign,\r\n      __sbjs_content,\r\n      __sbjs_term;\r\n\r\n  function mainData() {\r\n    var sbjs_data;\r\n    if (\r\n        typeof get_param.utm_source        !== 'undefined' ||\r\n        typeof get_param.utm_medium        !== 'undefined' ||\r\n        typeof get_param.utm_campaign      !== 'undefined' ||\r\n        typeof get_param.utm_content       !== 'undefined' ||\r\n        typeof get_param.utm_term          !== 'undefined' ||\r\n        typeof get_param.gclid             !== 'undefined' ||\r\n        typeof get_param.yclid             !== 'undefined' ||\r\n        typeof get_param[p.campaign_param] !== 'undefined' ||\r\n        typeof get_param[p.term_param]     !== 'undefined' ||\r\n        typeof get_param[p.content_param]  !== 'undefined'\r\n    ) {\r\n      setFirstAndCurrentExtraData();\r\n      sbjs_data = getData(terms.traffic.utm);\r\n    } else if (checkReferer(terms.traffic.organic)) {\r\n      setFirstAndCurrentExtraData();\r\n      sbjs_data = getData(terms.traffic.organic);\r\n    } else if (!cookies.get(data.containers.session) && checkReferer(terms.traffic.referral)) {\r\n      setFirstAndCurrentExtraData();\r\n      sbjs_data = getData(terms.traffic.referral);\r\n    } else if (!cookies.get(data.containers.first) && !cookies.get(data.containers.current)) {\r\n      setFirstAndCurrentExtraData();\r\n      sbjs_data = getData(terms.traffic.typein);\r\n    } else {\r\n      return cookies.get(data.containers.current);\r\n    }\r\n\r\n    return sbjs_data;\r\n  }\r\n\r\n  function getData(type) {\r\n\r\n    switch (type) {\r\n\r\n      case terms.traffic.utm:\r\n\r\n        __sbjs_type = terms.traffic.utm;\r\n\r\n        if (typeof get_param.utm_source !== 'undefined') {\r\n          __sbjs_source = get_param.utm_source;\r\n        } else if (typeof get_param.gclid !== 'undefined') {\r\n          __sbjs_source = 'google';\r\n        } else if (typeof get_param.yclid !== 'undefined') {\r\n          __sbjs_source = 'yandex';  \r\n        } else {\r\n          __sbjs_source = terms.none;\r\n        }\r\n\r\n        if (typeof get_param.utm_medium !== 'undefined') {\r\n          __sbjs_medium = get_param.utm_medium;\r\n        } else if (typeof get_param.gclid !== 'undefined') {\r\n          __sbjs_medium = 'cpc';\r\n        } else if (typeof get_param.yclid !== 'undefined') {\r\n          __sbjs_medium = 'cpc';  \r\n        } else {\r\n          __sbjs_medium = terms.none;\r\n        }\r\n\r\n        if (typeof get_param.utm_campaign !== 'undefined') {\r\n          __sbjs_campaign = get_param.utm_campaign;\r\n        } else if (typeof get_param[p.campaign_param] !== 'undefined') {\r\n          __sbjs_campaign = get_param[p.campaign_param];\r\n        } else if (typeof get_param.gclid !== 'undefined') {\r\n          __sbjs_campaign = 'google_cpc';\r\n        } else if (typeof get_param.yclid !== 'undefined') {\r\n          __sbjs_campaign = 'yandex_cpc';  \r\n        } else {\r\n          __sbjs_campaign = terms.none;\r\n        }\r\n\r\n        if (typeof get_param.utm_content !== 'undefined') {\r\n          __sbjs_content = get_param.utm_content;\r\n        } else if (typeof get_param[p.content_param] !== 'undefined') {\r\n          __sbjs_content = get_param[p.content_param];\r\n        } else {\r\n          __sbjs_content = terms.none;\r\n        }\r\n\r\n        if (typeof get_param.utm_term !== 'undefined') {\r\n          __sbjs_term = get_param.utm_term;\r\n        } else if (typeof get_param[p.term_param] !== 'undefined') {\r\n          __sbjs_term = get_param[p.term_param];\r\n        } else {\r\n          __sbjs_term = getUtmTerm() || terms.none;\r\n        }\r\n\r\n        break;\r\n\r\n      case terms.traffic.organic:\r\n        __sbjs_type     = terms.traffic.organic;\r\n        __sbjs_source   = __sbjs_source || uri.getHost(document.referrer);\r\n        __sbjs_medium   = terms.referer.organic;\r\n        __sbjs_campaign = terms.none;\r\n        __sbjs_content  = terms.none;\r\n        __sbjs_term     = terms.none;\r\n        break;\r\n\r\n      case terms.traffic.referral:\r\n        __sbjs_type     = terms.traffic.referral;\r\n        __sbjs_source   = __sbjs_source || uri.getHost(document.referrer);\r\n        __sbjs_medium   = __sbjs_medium || terms.referer.referral;\r\n        __sbjs_campaign = terms.none;\r\n        __sbjs_content  = uri.parse(document.referrer).path;\r\n        __sbjs_term     = terms.none;\r\n        break;\r\n\r\n      case terms.traffic.typein:\r\n        __sbjs_type     = terms.traffic.typein;\r\n        __sbjs_source   = p.typein_attributes.source;\r\n        __sbjs_medium   = p.typein_attributes.medium;\r\n        __sbjs_campaign = terms.none;\r\n        __sbjs_content  = terms.none;\r\n        __sbjs_term     = terms.none;\r\n        break;\r\n\r\n      default:\r\n        __sbjs_type     = terms.oops;\r\n        __sbjs_source   = terms.oops;\r\n        __sbjs_medium   = terms.oops;\r\n        __sbjs_campaign = terms.oops;\r\n        __sbjs_content  = terms.oops;\r\n        __sbjs_term     = terms.oops;\r\n    }\r\n    var sbjs_data = {\r\n      type:             __sbjs_type,\r\n      source:           __sbjs_source,\r\n      medium:           __sbjs_medium,\r\n      campaign:         __sbjs_campaign,\r\n      content:          __sbjs_content,\r\n      term:             __sbjs_term\r\n    };\r\n\r\n    return data.pack.main(sbjs_data);\r\n\r\n  }\r\n\r\n  function getUtmTerm() {\r\n    var referer = document.referrer;\r\n    if (get_param.utm_term) {\r\n      return get_param.utm_term;\r\n    } else if (referer && uri.parse(referer).host && uri.parse(referer).host.match(/^(?:.*\\.)?yandex\\..{2,9}$/i)) {\r\n      try {\r\n        return uri.getParam(uri.parse(document.referrer).query).text;\r\n      } catch (err) {\r\n        return false;\r\n      }\r\n    } else {\r\n      return false;\r\n    }\r\n  }\r\n\r\n  function checkReferer(type) {\r\n    var referer = document.referrer;\r\n    switch(type) {\r\n      case terms.traffic.organic:\r\n        return (!!referer && checkRefererHost(referer) && isOrganic(referer));\r\n      case terms.traffic.referral:\r\n        return (!!referer && checkRefererHost(referer) && isReferral(referer));\r\n      default:\r\n        return false;\r\n    }\r\n  }\r\n\r\n  function checkRefererHost(referer) {\r\n    if (p.domain) {\r\n      if (!isolate) {\r\n        var host_regex = new RegExp('^(?:.*\\\\.)?' + utils.escapeRegexp(domain) + '$', 'i');\r\n        return !(uri.getHost(referer).match(host_regex));\r\n      } else {\r\n        return (uri.getHost(referer) !== uri.getHost(domain));\r\n      }\r\n    } else {\r\n      return (uri.getHost(referer) !== uri.getHost(document.location.href));\r\n    }\r\n  }\r\n\r\n  function isOrganic(referer) {\r\n\r\n    var y_host  = 'yandex',\r\n        y_param = 'text',\r\n        g_host  = 'google';\r\n\r\n    var y_host_regex  = new RegExp('^(?:.*\\\\.)?'  + utils.escapeRegexp(y_host)  + '\\\\..{2,9}$'),\r\n        y_param_regex = new RegExp('.*'           + utils.escapeRegexp(y_param) + '=.*'),\r\n        g_host_regex  = new RegExp('^(?:www\\\\.)?' + utils.escapeRegexp(g_host)  + '\\\\..{2,9}$');\r\n\r\n    if (\r\n        !!uri.parse(referer).query &&\r\n        !!uri.parse(referer).host.match(y_host_regex) &&\r\n        !!uri.parse(referer).query.match(y_param_regex)\r\n      ) {\r\n      __sbjs_source = y_host;\r\n      return true;\r\n    } else if (!!uri.parse(referer).host.match(g_host_regex)) {\r\n      __sbjs_source = g_host;\r\n      return true;\r\n    } else if (!!uri.parse(referer).query) {\r\n      for (var i = 0; i < p.organics.length; i++) {\r\n        if (\r\n            uri.parse(referer).host.match(new RegExp('^(?:.*\\\\.)?' + utils.escapeRegexp(p.organics[i].host)  + '$', 'i')) &&\r\n            uri.parse(referer).query.match(new RegExp('.*'         + utils.escapeRegexp(p.organics[i].param) + '=.*', 'i'))\r\n          ) {\r\n          __sbjs_source = p.organics[i].display || p.organics[i].host;\r\n          return true;\r\n        }\r\n        if (i + 1 === p.organics.length) {\r\n          return false;\r\n        }\r\n      }\r\n    } else {\r\n      return false;\r\n    }\r\n  }\r\n\r\n  function isReferral(referer) {\r\n    if (p.referrals.length > 0) {\r\n      for (var i = 0; i < p.referrals.length; i++) {\r\n        if (uri.parse(referer).host.match(new RegExp('^(?:.*\\\\.)?' + utils.escapeRegexp(p.referrals[i].host) + '$', 'i'))) {\r\n          __sbjs_source = p.referrals[i].display  || p.referrals[i].host;\r\n          __sbjs_medium = p.referrals[i].medium   || terms.referer.referral;\r\n          return true;\r\n        }\r\n        if (i + 1 === p.referrals.length) {\r\n          __sbjs_source = uri.getHost(referer);\r\n          return true;\r\n        }\r\n      }\r\n    } else {\r\n      __sbjs_source = uri.getHost(referer);\r\n      return true;\r\n    }\r\n  }\r\n\r\n  function setFirstAndCurrentExtraData() {\r\n    cookies.set(data.containers.current_extra, data.pack.extra(p.timezone_offset), lifetime, domain, isolate);\r\n    if (!cookies.get(data.containers.first_extra)) {\r\n      cookies.set(data.containers.first_extra, data.pack.extra(p.timezone_offset), lifetime, domain, isolate);\r\n    }\r\n  }\r\n\r\n  (function setData() {\r\n\r\n    if (get_param.ldg && blacklist.includes(get_param.ldg)) {\r\n      // destroy sourcebuster cookies on blacklist\r\n      Object.values(data.containers).map(function(cookie) {\r\n        cookies.destroy(cookie, domain, isolate);\r\n      });\r\n      return;\r\n    }\r\n    // Main data\r\n    cookies.set(data.containers.current, mainData(), lifetime, domain, isolate);\r\n    if (!cookies.get(data.containers.first)) {\r\n      cookies.set(data.containers.first, cookies.get(data.containers.current), lifetime, domain, isolate);\r\n    }\r\n\r\n    // User data\r\n    var visits, udata;\r\n    if (!cookies.get(data.containers.udata)) {\r\n      visits  = 1;\r\n      udata   = data.pack.user(visits, p.user_ip);\r\n    } else {\r\n      visits  = parseInt(cookies.parse(data.containers.udata)[cookies.unsbjs(data.containers.udata)][data.aliases.udata.visits]) || 1;\r\n      visits  = cookies.get(data.containers.session) ? visits : visits + 1;\r\n      udata   = data.pack.user(visits, p.user_ip);\r\n    }\r\n    cookies.set(data.containers.udata, udata, lifetime, domain, isolate);\r\n\r\n    // Session\r\n    var pages_count;\r\n    if (!cookies.get(data.containers.session)) {\r\n      pages_count = 1;\r\n    } else {\r\n      pages_count = parseInt(cookies.parse(data.containers.session)[cookies.unsbjs(data.containers.session)][data.aliases.session.pages_seen]) || 1;\r\n      pages_count += 1;\r\n    }\r\n    console.log('data.containers.session', data.containers.session);\r\n    cookies.set(data.containers.session, data.pack.session(pages_count), p.session_length, domain, isolate);\r\n\r\n    // Promocode\r\n    if (p.promocode && !cookies.get(data.containers.promocode)) {\r\n      cookies.set(data.containers.promocode, data.pack.promo(p.promocode), lifetime, domain, isolate);\r\n    }\r\n\r\n  })();\r\n\r\n  return cookies.parse(data.containers);\r\n\r\n};","\"use strict\";\r\n\r\nvar data    = require('./data'),\r\n    cookies = require('./helpers/cookies');\r\n\r\nmodule.exports = {\r\n\r\n  go: function(lifetime, domain, isolate) {\r\n\r\n    var migrate = this.migrations,\r\n        _with   = { l: lifetime, d: domain, i: isolate };\r\n\r\n    var i;\r\n\r\n    if (!cookies.get(data.containers.first) && !cookies.get(data.service.migrations)) {\r\n\r\n      var mids = [];\r\n      for (i = 0; i < migrate.length; i++) { mids.push(migrate[i].id); }\r\n\r\n      var advance = '';\r\n      for (i = 0; i < mids.length; i++) {\r\n        advance += mids[i] + '=1';\r\n        if (i < mids.length - 1) { advance += data.delimiter; }\r\n      }\r\n      cookies.set(data.service.migrations, advance, _with.l, _with.d, _with.i);\r\n\r\n    } else if (!cookies.get(data.service.migrations)) {\r\n\r\n      // We have only one migration for now, so just\r\n      for (i = 0; i < migrate.length; i++) {\r\n        migrate[i].go(migrate[i].id, _with);\r\n      }\r\n\r\n    }\r\n\r\n  },\r\n\r\n  migrations: [\r\n\r\n    {\r\n      id: '1418474375998',\r\n      version: '1.0.0-beta',\r\n      go: function(mid, _with) {\r\n\r\n        var success = mid + '=1',\r\n            fail    = mid + '=0';\r\n\r\n        var safeReplace = function($0, $1, $2) {\r\n          return ($1 || $2 ? $0 : data.delimiter);\r\n        };\r\n\r\n        try {\r\n\r\n          // Switch delimiter and renew cookies\r\n          var _in = [];\r\n          for (var prop in data.containers) {\r\n            if (data.containers.hasOwnProperty(prop)) {\r\n              _in.push(data.containers[prop]);\r\n            }\r\n          }\r\n\r\n          for (var i = 0; i < _in.length; i++) {\r\n            if (cookies.get(_in[i])) {\r\n              var buffer = cookies.get(_in[i]).replace(/(\\|)?\\|(\\|)?/g, safeReplace);\r\n              cookies.destroy(_in[i], _with.d, _with.i);\r\n              cookies.destroy(_in[i], _with.d, !_with.i);\r\n              cookies.set(_in[i], buffer, _with.l, _with.d, _with.i);\r\n            }\r\n          }\r\n\r\n          // Update `session`\r\n          if (cookies.get(data.containers.session)) {\r\n            cookies.set(data.containers.session, data.pack.session(0), _with.l, _with.d, _with.i);\r\n          }\r\n\r\n          // Yay!\r\n          cookies.set(data.service.migrations, success, _with.l, _with.d, _with.i);\r\n\r\n        } catch (err) {\r\n          // Oops\r\n          cookies.set(data.service.migrations, fail, _with.l, _with.d, _with.i);\r\n        }\r\n      }\r\n    }\r\n\r\n  ]\r\n\r\n};","\"use strict\";\r\n\r\nvar terms = require('./terms'),\r\n    uri   = require('./helpers/uri');\r\n\r\nmodule.exports = {\r\n\r\n  fetch: function(prefs) {\r\n\r\n    var user   = prefs || {},\r\n        params = {};\r\n\r\n    // Set `lifetime of the cookie` in months\r\n    params.lifetime = this.validate.checkFloat(user.lifetime) || 6;\r\n    params.lifetime = parseInt(params.lifetime * 30 * 24 * 60);\r\n\r\n    // Set `session length` in minutes\r\n    params.session_length = this.validate.checkInt(user.session_length) || 30;\r\n\r\n    // Set `timezone offset` in hours\r\n    params.timezone_offset = this.validate.checkInt(user.timezone_offset);\r\n\r\n    // Set `campaign param` for AdWords links\r\n    params.campaign_param = user.campaign_param || false;\r\n\r\n    // Set `term param` and `content param` for AdWords links\r\n    params.term_param = user.term_param || false;\r\n    params.content_param = user.content_param || false;\r\n\r\n    // Set `user ip`\r\n    params.user_ip = user.user_ip || terms.none;\r\n\r\n    // Set `promocode`\r\n    if (user.promocode) {\r\n      params.promocode = {};\r\n      params.promocode.min = parseInt(user.promocode.min) || 100000;\r\n      params.promocode.max = parseInt(user.promocode.max) || 999999;\r\n    } else {\r\n      params.promocode = false;\r\n    }\r\n\r\n    // Set `typein attributes`\r\n    if (user.typein_attributes && user.typein_attributes.source && user.typein_attributes.medium) {\r\n      params.typein_attributes = {};\r\n      params.typein_attributes.source = user.typein_attributes.source;\r\n      params.typein_attributes.medium = user.typein_attributes.medium;\r\n    } else {\r\n      params.typein_attributes = { source: '(direct)', medium: '(none)' };\r\n    }\r\n\r\n    // Set `domain`\r\n    if (user.domain && this.validate.isString(user.domain)) {\r\n      params.domain = { host: user.domain, isolate: false };\r\n    } else if (user.domain && user.domain.host) {\r\n      params.domain = user.domain;\r\n    } else {\r\n      params.domain = { host: uri.getHost(document.location.hostname), isolate: false };\r\n    }\r\n\r\n    // Set `referral sources`\r\n    params.referrals = [];\r\n\r\n    if (user.referrals && user.referrals.length > 0) {\r\n      for (var ir = 0; ir < user.referrals.length; ir++) {\r\n        if (user.referrals[ir].host) {\r\n          params.referrals.push(user.referrals[ir]);\r\n        }\r\n      }\r\n    }\r\n\r\n    // Set `organic sources`\r\n    params.organics = [];\r\n\r\n    if (user.organics && user.organics.length > 0) {\r\n      for (var io = 0; io < user.organics.length; io++) {\r\n        if (user.organics[io].host && user.organics[io].param) {\r\n          params.organics.push(user.organics[io]);\r\n        }\r\n      }\r\n    }\r\n\r\n    params.organics.push({ host: 'bing.com',      param: 'q',     display: 'bing'            });\r\n    params.organics.push({ host: 'yahoo.com',     param: 'p',     display: 'yahoo'           });\r\n    params.organics.push({ host: 'about.com',     param: 'q',     display: 'about'           });\r\n    params.organics.push({ host: 'aol.com',       param: 'q',     display: 'aol'             });\r\n    params.organics.push({ host: 'ask.com',       param: 'q',     display: 'ask'             });\r\n    params.organics.push({ host: 'globososo.com', param: 'q',     display: 'globo'           });\r\n    params.organics.push({ host: 'go.mail.ru',    param: 'q',     display: 'go.mail.ru'      });\r\n    params.organics.push({ host: 'rambler.ru',    param: 'query', display: 'rambler'         });\r\n    params.organics.push({ host: 'tut.by',        param: 'query', display: 'tut.by'          });\r\n\r\n    params.referrals.push({ host: 't.co',                         display: 'twitter.com'     });\r\n    params.referrals.push({ host: 'plus.url.google.com',          display: 'plus.google.com' });\r\n\r\n\r\n    return params;\r\n\r\n  },\r\n\r\n  validate: {\r\n\r\n    checkFloat: function(v) {\r\n      return v && this.isNumeric(parseFloat(v)) ? parseFloat(v) : false;\r\n    },\r\n\r\n    checkInt: function(v) {\r\n      return v && this.isNumeric(parseInt(v)) ? parseInt(v) : false;\r\n    },\r\n\r\n    isNumeric: function(v){\r\n      return !isNaN(v);\r\n    },\r\n\r\n    isString: function(v) {\r\n      return Object.prototype.toString.call(v) === '[object String]';\r\n    }\r\n\r\n  }\r\n\r\n};","\"use strict\";\r\n\r\nmodule.exports = {\r\n\r\n  traffic: {\r\n    utm:        'utm',\r\n    organic:    'organic',\r\n    referral:   'referral',\r\n    typein:     'typein'\r\n  },\r\n\r\n  referer: {\r\n    referral:   'referral',\r\n    organic:    'organic',\r\n    social:     'social'\r\n  },\r\n\r\n  none:         '(none)',\r\n  oops:         '(Houston, we have a problem)'\r\n\r\n};\r\n"]}